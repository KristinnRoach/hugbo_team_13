<html xmlns:th="http://www.thymeleaf.org" th:replace="~{layout :: layout(~{::title}, ~{::section})}">
<head>
    <title>Update Profile</title>
</head>

<body>

<!-- Read-only ID -->
<p><strong>ID:</strong> <span th:text="${user.id}">ID</span></p>
<!-- Editable form -->

<th:block  th:if="${session.loggedInUser.getId() == user.id}">

<form
      th:action="@{/user/{id}(id=${user.id})}"
      method="post"
      enctype="multipart/form-data">
    <input type="hidden" name="_method" value="PUT"/>

    <div class="form-group">
        <label for="username"><strong>Username:</strong></label>
        <input type="text" id="username" name="username" th:value="${user.username}" required/>
    </div>

    <div class="form-group">
        <label for="email"><strong>Email:</strong></label>
        <input type="email" id="email" name="email" th:value="${user.email}" required/>
    </div>

    <div class="form-group">
        <label for="profilePicture"><strong>Profile Picture:</strong></label>
        <input type="file" id="profilePicture" name="profilePicture" accept="image/*"/>
        <!-- Show current profile picture -->
        <img th:if="${user.profilePicture}" th:src="@{/user/{id}/profile-picture(id=${user.id})}"
             alt="Current Profile Picture" style="max-width: 200px; margin-top: 10px;"/>
    </div>

    <button type="submit" class="btn">Save Changes</button>
</form>

<form th:if="${user.id == session.loggedInUser.id}" th:action="@{/user/{id}(id=${user.id})}" method="post" style="display: inline;">
    <input type="hidden" name="_method" value="DELETE"/>
    <button style="color: darkred" type="submit">Delete Account</button>
</form>

</th:block>

</body>
</html>